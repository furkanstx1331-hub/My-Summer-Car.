<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tactical Dodge ULTRA</title>

<style>
body{
    margin:0;
    background:radial-gradient(circle at center,#0f2027,#0a0a0a);
    display:flex;
    justify-content:center;
    align-items:center;
    flex-direction:column;
    height:100vh;
    font-family:Arial;
    color:white;
    overflow:hidden;
}

canvas{
    border-radius:20px;
    box-shadow:0 0 60px #00ffcc55;
    background:linear-gradient(135deg,#0f0f0f,#111);
    max-width:95vw;
}

#ui{
    text-align:center;
    margin-top:10px;
}

button{
    padding:8px;
    margin:4px;
    background:#00ffcc;
    border:none;
    cursor:pointer;
    font-weight:bold;
    border-radius:10px;
}
button:hover{background:#00ddaa;}

#controls{
    margin-top:10px;
    display:grid;
    grid-template-columns:70px 70px 70px;
    gap:10px;
    justify-content:center;
}
.control-btn{
    background:#222;
    color:white;
    font-size:22px;
    border-radius:12px;
}
</style>
</head>
<body>

<canvas id="game" width="420" height="420"></canvas>

<div id="ui">
    <h3>SKOR: <span id="score">0</span> | ‚ù§Ô∏è <span id="lives">3</span></h3>

    <button onclick="setMode('easy')">üü¢ Easy</button>
    <button onclick="setMode('normal')">üü° Normal</button>
    <button onclick="setMode('hard')">üî¥ Hard</button>
    <button onclick="init()">Yeniden Ba≈ülat</button>
</div>

<div id="controls">
    <div></div>
    <button class="control-btn" onclick="move('up')">‚¨Ü</button>
    <div></div>
    <button class="control-btn" onclick="move('left')">‚¨Ö</button>
    <div></div>
    <button class="control-btn" onclick="move('right')">‚û°</button>
    <div></div>
    <button class="control-btn" onclick="move('down')">‚¨á</button>
    <div></div>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let grid = 7;
let size = canvas.width / grid;

let player, gold, enemies, score, speed, moveTimer, enemySpawner, lives;
let mode="easy";

function setMode(m){ mode=m; init(); }

function init(){

    if(mode==="easy"){ speed=1400; lives=3; }
    if(mode==="normal"){ speed=900; lives=2; }
    if(mode==="hard"){ speed=600; lives=1; }

    player={x:3,y:3};
    enemies=[];
    score=0;

    document.getElementById("score").innerText=score;
    document.getElementById("lives").innerText=lives;

    spawnGold();

    clearInterval(moveTimer);
    clearInterval(enemySpawner);

    moveTimer=setInterval(moveEnemies,speed);
    enemySpawner=setInterval(spawnEnemy,3000);

    draw();
}

function spawnGold(){
    gold={
        x:Math.floor(Math.random()*grid),
        y:Math.floor(Math.random()*grid)
    };
}

function spawnEnemy(){
    const edge=Math.floor(Math.random()*4);
    let x,y;

    if(edge===0){x=0;y=Math.floor(Math.random()*grid);}
    if(edge===1){x=grid-1;y=Math.floor(Math.random()*grid);}
    if(edge===2){y=0;x=Math.floor(Math.random()*grid);}
    if(edge===3){y=grid-1;x=Math.floor(Math.random()*grid);}

    if(x===player.x && y===player.y) return;

    enemies.push({x,y,nextX:x,nextY:y});
}

function chooseDirection(enemy){
    const dirs=[
        {dx:1,dy:0},
        {dx:-1,dy:0},
        {dx:0,dy:1},
        {dx:0,dy:-1}
    ];
    const d=dirs[Math.floor(Math.random()*4)];

    let nx=enemy.x+d.dx;
    let ny=enemy.y+d.dy;

    if(nx>=0 && nx<grid) enemy.nextX=nx;
    else enemy.nextX=enemy.x;

    if(ny>=0 && ny<grid) enemy.nextY=ny;
    else enemy.nextY=enemy.y;
}

function moveEnemies(){
    enemies.forEach(e=>{
        chooseDirection(e);
    });

    draw(); // √∂nce y√∂n√º g√∂ster

    setTimeout(()=>{
        enemies.forEach(e=>{
            e.x=e.nextX;
            e.y=e.nextY;
        });
        checkCollision();
        draw();
    },300);
}

function checkCollision(){
    enemies.forEach(e=>{
        if(e.x===player.x && e.y===player.y){
            lives--;
            document.getElementById("lives").innerText=lives;
            if(lives<=0){
                alert("GAME OVER\nSkor: "+score);
                init();
            }
        }
    });
}

function move(dir){
    if(dir==="up"&&player.y>0) player.y--;
    if(dir==="down"&&player.y<grid-1) player.y++;
    if(dir==="left"&&player.x>0) player.x--;
    if(dir==="right"&&player.x<grid-1) player.x++;

    if(player.x===gold.x && player.y===gold.y){
        score++;
        document.getElementById("score").innerText=score;
        spawnGold();

        if(speed>450){
            speed-=50;
            clearInterval(moveTimer);
            moveTimer=setInterval(moveEnemies,speed);
        }
    }

    checkCollision();
    draw();
}

document.addEventListener("keydown",e=>{
    if(e.key==="ArrowUp"||e.key==="w") move("up");
    if(e.key==="ArrowDown"||e.key==="s") move("down");
    if(e.key==="ArrowLeft"||e.key==="a") move("left");
    if(e.key==="ArrowRight"||e.key==="d") move("right");
});

function drawGrid(){
    for(let i=0;i<grid;i++){
        for(let j=0;j<grid;j++){
            ctx.strokeStyle="#222";
            ctx.strokeRect(i*size,j*size,size,size);
        }
    }
}

function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    drawGrid();

    // GOLD
    ctx.save();
    ctx.shadowBlur=25;
    ctx.shadowColor="gold";
    ctx.fillStyle="gold";
    ctx.beginPath();
    ctx.arc(gold.x*size+size/2,gold.y*size+size/2,size/4,0,Math.PI*2);
    ctx.fill();
    ctx.restore();

    // PLAYER
    ctx.save();
    ctx.shadowBlur=30;
    ctx.shadowColor="#00ffcc";
    ctx.fillStyle="#00ffcc";
    ctx.fillRect(player.x*size+8,player.y*size+8,size-16,size-16);
    ctx.restore();

    // ENEMIES
    enemies.forEach(e=>{

        // hedef kareyi g√∂ster
        ctx.fillStyle="rgba(255,0,0,0.2)";
        ctx.fillRect(e.nextX*size,e.nextY*size,size,size);

        // d√º≈üman glow
        ctx.save();
        ctx.shadowBlur=25;
        ctx.shadowColor="red";
        ctx.fillStyle="red";
        ctx.fillRect(e.x*size+8,e.y*size+8,size-16,size-16);
        ctx.restore();

        // y√∂n oku
        ctx.fillStyle="white";
        ctx.font="18px Arial";
        let arrow="";
        if(e.nextX>e.x) arrow="‚Üí";
        if(e.nextX<e.x) arrow="‚Üê";
        if(e.nextY>e.y) arrow="‚Üì";
        if(e.nextY<e.y) arrow="‚Üë";
        ctx.fillText(arrow,e.x*size+size/2-6,e.y*size+size/2+6);
    });
}

init();
</script>

</body>
</html>

